"use strict";define("Tfs/Platform",["require","exports","react","VSS/Platform/Layout","VSSUI/Button","VSSUI/Link","VSS/Core/Observable","VSS/Features/PlatformUI/ContributedTab","VSSUI/Tabs","VSS/Platform/Context","VSS/Core/Util/String","VSS/Platform/FPS","VSS/Platform/Location","VSS/Platform/UserClaims","VSS/Platform/Util/Cookie","VSS/Platform/Util/Storage","VSSUI/VssPersona","VSS/Platform/RestClientBase","VSS/Platform/Util/Serialization","VSS/Platform/Feature"],function(e,t,s,r,o,a,i,n,c,u,p,l,d,m,g,v,h,S,b,f){var y;y=t.Resources={},Object.defineProperty(t,"__esModule",{value:!0}),t.Resources.ManageUserSettings="Manage the currently logged in user settings",t.Resources.MoreMenu="More ...",t.Resources.Pin="Pin",t.Resources.RecentProjectTeams="Recent project/teams",t.Resources.Unpin="Unpin",t.Resources.UnpinnedItems="Unpinned items",t.Resources.DocumentTitle="{0} - {1}",t.Resources.ApplicationTitleHosted="Azure DevOps Services",t.Resources.ApplicationTitleOnPrem="Azure DevOps Server",t.Resources.DevSuite="Dev Suite",t.Resources.Favorites="Favorites",t.Resources.Create="Create",t.Resources.Help="Help",t.Resources.Settings="Settings",t.Resources.ProjectSettings="Project settings",t.Resources.ShowDetails="Show more information",t.Resources.HideDetails="Show less information",t.Resources.ShowFavorites="Show favorites",t.Resources.ShowCreate="Show commonly created items",t.Resources.ShowApplications="Switch to another application",t.Resources.ProjectsAndTeams="Projects & teams",t.Resources.HeaderProjectNameFormat="{0} / {1}",t.Resources.Navigation_Site="Website",t.Resources.Dashboards="Dashboards",t.Resources.Wiki="Wiki",t.Resources.More="More",t.Resources.BrandName="Azure",t.Resources.ProductName="DevOps",t.Resources.BrandWithProductName="Azure DevOps",t.Resources.SuiteNameOnPrem="DevOps",t.Resources.SuiteName="VSTS",t.Resources.MarketPlace="Marketplace",t.Resources.Overview="Overview",t.Resources.UnhandledErrorTitle="An unexpected error has occurred within this region of the page.",t.Resources.UnhandledErrorMessage="You can try reloading this component or refreshing the entire page.",t.Resources.RefreshPageText="Refresh page",t.Resources.ReloadComponentText="Reload component",t.Resources.ShowMoreInfoText="Show more info",t.Resources.SuiteLogoLabel="Azure DevOps organization home page",t.Resources.SuiteLogoLabelOnPrem="Azure DevOps collection home page",t.Resources.Error="Error",t.Resources.Stack="Stack",function(e){t.HeaderActions={},Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderActions.getHeaderActionData=function(e){return e.getService("IVssContributionService").getData("ms.vss-tfs-web.header-action-data")}}(),function(e){t.ErrorHandling={},Object.defineProperty(t,"__esModule",{value:!0});r.Components.add("tfs.page-error-handler",class extends r.VssComponent{constructor(e){super(e),this.state={hideInfo:!0}}render(){return s.createElement("div",{className:"flex flex-column tfs-unhandled-error"},s.createElement("div",{className:"tfs-unhandled-error--title"},y.UnhandledErrorTitle),s.createElement("div",null,y.UnhandledErrorMessage),s.createElement("div",{className:"tfs-unhandled-error--buttons flex flex-noshrink justify-start"},s.createElement(o.Button,{primary:!0,onClick:()=>{window.location.reload()}},y.RefreshPageText),s.createElement(o.Button,{onClick:()=>{this.props.reloadComponent()}},y.ReloadComponentText)),s.createElement("div",{className:"tfs-unhandled-error--moreInfo"},this.state.hideInfo?s.createElement(a.Link,{onClick:e=>{this.setState({hideInfo:!1}),e.preventDefault()}},y.ShowMoreInfoText):s.createElement("div",null,s.createElement("div",{className:"tfs-unhandled-error--title"},y.Error,": ",this.props.error.message),s.createElement("div",{className:"tfs-unhandled-error--stack"},s.createElement("div",{className:"tfs-unhandled-error--title"},y.Stack),this.props.errorInfo.componentStack.trim()))))}})}(),function(e){t.MyWorkFlyout={},Object.defineProperty(t,"__esModule",{value:!0});class o extends r.VssComponent{constructor(e,t){if(super(e,t),this._onTabClicked=(e=>{o._defaultTabKey=e,this.context.pageContext.getService("ISettingsService").setEntries({[o.DefaultPivotStorageKey]:e},0),this._selectedTabId.value=e}),this._tabs=n.getTabs(t.pageContext,"ms.vss-tfs-web.my-work-pivot"),!o._defaultTabKey){const e=t.pageContext.getService("ISettingsService");o._defaultTabKey=e.getEntry(o.DefaultPivotStorageKey,0)}this._selectedTabId=new i.ObservableValue(o._defaultTabKey||"work-items")}render(){return s.createElement("div",{className:r.css("flex-column flex-grow scroll-hidden",this.props.className)},s.createElement(c.TabProvider,{selectedTabId:this._selectedTabId,providers:this._tabs},s.createElement(c.TabBar,{className:"flyout-my-work-tabs",onSelectedTabChanged:this._onTabClicked,disableSticky:!0}),s.createElement(c.TabContent,null)))}}o.DefaultPivotStorageKey="navigation/myworkdefaultpivot",o.componentType="vertical-header-my-work-flyout",r.VssComponent.register(o.componentType,o)}(),function(e){t.NavigationSettings={},Object.defineProperty(t,"__esModule",{value:!0});const s="ms.vss-tfs-web.navigation-settings-data-provider",r="Navigation/",o="user";u.Services.add("ITfsNavigationSettingsService",{serviceFactory:class extends u.VssService{_serviceStart(e){super._serviceStart(e);const t=e.getService("IVssContributionService");this._prefs=t.getData(s)||{},this._prefs[o]||(this._prefs[o]={})}setUserSetting(e,t){this._prefs[o][e]=t;const s={};return s[r+e]=t,this.pageContext.getService("ISettingsService").setEntries(s,0)}getUserSetting(e,t){const s=this._prefs[o][e];return null!=s?s:t}}})}(),function(e){t.Page={},Object.defineProperty(t,"__esModule",{value:!0});u.Services.add("ITfsPageService",{serviceFactory:class extends u.VssService{constructor(){super(...arguments),this.addTelemetryProperties=(e=>{const t=this.getData();t&&t.project&&(e.properties.dataspaceId=t.project.id,e.properties.dataspaceType="Project",e.properties.dataspaceVisibility=t.project.visibility.toString())})}_serviceStart(e){super._serviceStart(e);const t=e.getService("IVssTelemetryService");t.subscribe(this.addTelemetryProperties,"publish"),this._removeSubscriptions=(()=>{t.unsubscribe(this.addTelemetryProperties,"publish")})}_serviceEnd(e){this._removeSubscriptions(),super._serviceEnd(e)}getData(){return this.pageContext.getService("IVssContributionService").getData("ms.vss-tfs-web.page-data")}getHorizontalNavigationTeamData(){return this.pageContext.getService("IVssContributionService").getData("ms.vss-tfs-web.team-context-data-provider")}},options:4});function s(e){const t=e.getService("ITfsPageService");if(t)return t.getData()}u.Services.add("ms.vss-tfs-web.tfs-page-data-service",{serviceFactory:class extends u.VssService{getProject(){const e=this.pageContext.getService("ITfsPageService").getData();return e&&e.project?{id:e.project.id,name:e.project.name}:void 0}},options:1}),t.Page.getTFSPageData=s,t.Page.getTFSProject=function(e){const t=s(e);return t&&t.project}}(),function(e){t.Navigation={},Object.defineProperty(t,"__esModule",{value:!0});const s="ms.vss-admin-web.project-admin-hub-route";!function(e){e.navigationElementModified="navigationElementModified"}(t.Navigation.TfsNavigationServiceEventNames||(t.Navigation.TfsNavigationServiceEventNames={}));const r="vmExpanded";u.Services.add("ITfsNavigationService",{serviceFactory:class extends u.VssObservableService{_serviceStart(e){super._serviceStart(e);const t=e.getService("IVssNavigationService"),s=t.getDisplayedNavigation();if(s.length>3){const e=s[2],r=t.getNavigation(e);r&&r.name&&(this.titleSuffix=r.name)}if(!this.titleSuffix){const e=this.pageContext.getService("IVssPageService").getData();this.titleSuffix=e&&e.isHosted?y.ApplicationTitleHosted:y.ApplicationTitleOnPrem}const r=t.getPageTitle();if(r&&this.setPageTitle(r),s.length>3){const e=t.getNavigation(s[3]);e&&0==(32&e.flags)&&this.setMostRecentHubForHubGroup(s[2],s[3])}}getMostRecentHubForHubGroup(e){const t=v.tryGetLocalStorageValue("lastHub/"+e.id,null);let s;return t&&e.children&&(s=e.children.filter(e=>e.id===t)[0],"ms.vss-dashboards-web.dashboards-hub"===t)&&(s=this.pageContext.getService("IVssNavigationService").getNavigation(t)),s}setMostRecentHubForHubGroup(e,t){v.trySetLocalStorageValue("lastHub/"+e,t)}setPageTitle(e){document.title=p.format(y.DocumentTitle,e,this.titleSuffix)}getNavigationDisplayMode(){if(void 0===this.navigationDisplayMode){let e=void 0;if(m.userHasClaim(this.pageContext,"member")&&(e=this.pageContext.getService("ISettingsService").getEntry("navigation/verticalMenuExpanded",0)),this.pageContext.getService("IVssNavigationService").getCurrentRoute().routeId===s&&(e=1),void 0===e){const t=g.getCookie(r);t&&t.length>0&&(e=Number.parseInt(t))}this.navigationDisplayMode=new i.ObservableValue(e||2)}return this.navigationDisplayMode}setNavigationDisplayMode(e){this.navigationDisplayMode?this.navigationDisplayMode.value=e:this.navigationDisplayMode=new i.ObservableValue(e),m.userHasClaim(this.pageContext,"member")?this.pageContext.getService("ISettingsService").setEntries({"navigation/verticalMenuExpanded":e},0):g.setCookie(r,e.toString()),this._notify(e,"displayModeChanged")}navigateToNavElement(e){const t=this.pageContext.getService("IVssNavigationService").getNavigation(e);t&&t.href&&l.FastPageSwitch(this.pageContext,t.href,!0)}navigateToRoute(e,t){const s={};if(t){const e=this.pageContext.getService("ITfsPageService").getData();e&&e.project&&(s.project=e.project.name)}const r=d.routeUrl(this.pageContext,e,s);r&&l.FastPageSwitch(this.pageContext,r,!0)}navigateToHome(){this.navigateToRoute("ms.vss-tfs-web.suite-me-page-route")}_remove(e,t){const s=e.indexOf(t);return s>=0&&e.splice(s,1),s>=0}},options:4}),t.Navigation.isNavigationItemBuiltinOrTrusted=function(e){return void 0!==e.flags&&(1==(1&e.flags)||2==(2&e.flags))&&32!=(32&e.flags)}}(),function(e){t.ProductFeatures={},Object.defineProperty(t,"__esModule",{value:!0});u.Services.add("ITfsProductFeaturesService",{serviceFactory:class extends u.VssService{getProduct(e){const t=this.pageContext.getService("IVssContributionService").getData("ms.vss-tfs-web.product-features-data-provider");return t&&t.features?t.features[e]:void 0}}})}(),function(e){t.ProjectPersona={},Object.defineProperty(t,"__esModule",{value:!0});t.ProjectPersona.ProjectPersona=class extends s.Component{render(){const{displayName:e,size:t,url:r}=this.props,o={getDisplayName:()=>e,getIdentityImageUrl:e=>r};return s.createElement(h.VssPersona,{ariaLabel:null,cssClass:"project-persona flex-noshrink",size:t,identityDetailsProvider:o})}}}(),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0});t[e].CoreClientName="ICoreRestClient",t[e].getCoreClient=function(s,r){return s.getRestClient(t[e].CoreClientName,r)},u.RestClients.add(t[e].CoreClientName,{factory:class extends S.RestClientBase{constructor(e){super(e)}async removeProjectAvatar(e){return this.beginRequest({apiVersion:"5.1-preview.1",method:"DELETE",routeTemplate:"_apis/projects/{projectId}/avatar",routeValues:{projectId:e}})}async setProjectAvatar(e,t){return this.beginRequest({apiVersion:"5.1-preview.1",method:"PUT",routeTemplate:"_apis/projects/{projectId}/avatar",routeValues:{projectId:t},body:e})}async createConnectedService(e,t){return this.beginRequest({apiVersion:"5.1-preview.1",method:"POST",routeTemplate:"_apis/projects/{projectId}/connectedServices/{name}",routeValues:{projectId:t},body:e})}async getConnectedServiceDetails(e,t){return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/projects/{projectId}/connectedServices/{name}",routeValues:{projectId:e,name:t}})}async getConnectedServices(e,t){const s={kind:t};return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/projects/{projectId}/connectedServices/{name}",routeValues:{projectId:e},queryParams:s})}async createIdentityMru(e,t){return this.beginRequest({apiVersion:"5.1-preview.1",method:"POST",routeTemplate:"_apis/core/identityMru/{mruName}",routeValues:{mruName:t},body:e})}async deleteIdentityMru(e,t){return this.beginRequest({apiVersion:"5.1-preview.1",method:"DELETE",routeTemplate:"_apis/core/identityMru/{mruName}",routeValues:{mruName:t}})}async getIdentityMru(e){return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/core/identityMru/{mruName}",routeValues:{mruName:e}})}async updateIdentityMru(e,t){return this.beginRequest({apiVersion:"5.1-preview.1",method:"PATCH",routeTemplate:"_apis/core/identityMru/{mruName}",routeValues:{mruName:t},body:e})}async getTeamMembersWithExtendedProperties(e,t,s,r){const o={$top:s,$skip:r};return this.beginRequest({apiVersion:"5.1",routeTemplate:"_apis/projects/{projectId}/teams/{teamId}/members",routeValues:{projectId:e,teamId:t},queryParams:o})}async getProcessById(e){return this.beginRequest({apiVersion:"5.1",routeTemplate:"_apis/process/processes/{*processId}",routeValues:{processId:e}})}async getProcesses(){return this.beginRequest({apiVersion:"5.1",routeTemplate:"_apis/process/processes/{*processId}"})}async getProjectCollection(e){return this.beginRequest({apiVersion:"5.1",routeTemplate:"_apis/projectCollections/{collectionId}",routeValues:{collectionId:e}})}async getProjectCollections(e,t){const s={$top:e,$skip:t};return this.beginRequest({apiVersion:"5.1",routeTemplate:"_apis/projectCollections/{collectionId}",queryParams:s})}async getProjectHistoryEntries(e){const t={minRevision:e};return this.beginRequest({apiVersion:"5.1-preview.2",routeTemplate:"_apis/projectHistory",queryParams:t})}async getProject(e,t,s){const r={includeCapabilities:t,includeHistory:s};return this.beginRequest({apiVersion:"5.1",routeTemplate:"_apis/projects/{*projectId}",routeValues:{projectId:e},queryParams:r})}async getProjects(e,t,s,r,o){const a={stateFilter:e,$top:t,$skip:s,continuationToken:r,getDefaultTeamImageUrl:o};return this.beginRequest({apiVersion:"5.1",routeTemplate:"_apis/projects/{*projectId}",queryParams:a,returnRawResponse:!0}).then(async e=>{const t=await e.text().then(b.deserializeVssJsonObject);return t.continuationToken=e.headers.get("x-ms-continuationtoken"),t})}async queueCreateProject(e){return this.beginRequest({apiVersion:"5.1",method:"POST",routeTemplate:"_apis/projects/{*projectId}",body:e})}async queueDeleteProject(e){return this.beginRequest({apiVersion:"5.1",method:"DELETE",routeTemplate:"_apis/projects/{*projectId}",routeValues:{projectId:e}})}async updateProject(e,t){return this.beginRequest({apiVersion:"5.1",method:"PATCH",routeTemplate:"_apis/projects/{*projectId}",routeValues:{projectId:t},body:e})}async getProjectsProperties(e,t){const s={projectIds:e&&e.join(","),properties:t&&t.join(",")};return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/projectsproperties",queryParams:s})}async getProjectProperties(e,t){const s={keys:t&&t.join(",")};return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/projects/{projectId}/properties",routeValues:{projectId:e},queryParams:s})}async setProjectProperties(e,t){return this.beginRequest({apiVersion:"5.1-preview.1",method:"PATCH",routeTemplate:"_apis/projects/{projectId}/properties",routeValues:{projectId:e},customHeaders:{"Content-Type":"application/json-patch+json"},body:t})}async createOrUpdateProxy(e){return this.beginRequest({apiVersion:"5.1-preview.2",method:"PUT",routeTemplate:"_apis/proxies",body:e})}async deleteProxy(e,t){const s={proxyUrl:e,site:t};return this.beginRequest({apiVersion:"5.1-preview.2",method:"DELETE",routeTemplate:"_apis/proxies",queryParams:s})}async getProxies(e){const t={proxyUrl:e};return this.beginRequest({apiVersion:"5.1-preview.2",routeTemplate:"_apis/proxies",queryParams:t})}async createTeam(e,t){return this.beginRequest({apiVersion:"5.1",method:"POST",routeTemplate:"_apis/projects/{projectId}/teams/{*teamId}",routeValues:{projectId:t},body:e})}async deleteTeam(e,t){return this.beginRequest({apiVersion:"5.1",method:"DELETE",routeTemplate:"_apis/projects/{projectId}/teams/{*teamId}",routeValues:{projectId:e,teamId:t}})}async getTeam(e,t,s){const r={$expandIdentity:s};return this.beginRequest({apiVersion:"5.1",routeTemplate:"_apis/projects/{projectId}/teams/{*teamId}",routeValues:{projectId:e,teamId:t},queryParams:r})}async getTeams(e,t,s,r,o){const a={$mine:t,$top:s,$skip:r,$expandIdentity:o};return this.beginRequest({apiVersion:"5.1",routeTemplate:"_apis/projects/{projectId}/teams/{*teamId}",routeValues:{projectId:e},queryParams:a})}async updateTeam(e,t,s){return this.beginRequest({apiVersion:"5.1",method:"PATCH",routeTemplate:"_apis/projects/{projectId}/teams/{*teamId}",routeValues:{projectId:t,teamId:s},body:e})}async getAllTeams(e,t,s,r){const o={$mine:e,$top:t,$skip:s,$expandIdentity:r};return this.beginRequest({apiVersion:"5.1-preview.3",routeTemplate:"_apis/teams",queryParams:o})}},options:{resourceAreaId:"79134c72-4a58-4b42-976c-04e7115f32bf",serviceInstanceType:"00025394-6065-48ca-87d9-7f5672854ef7"}})}("RestClientCore"),function(e){t.SearchGlobalSearchCoordinator={},Object.defineProperty(t,"__esModule",{value:!0});u.Services.add("witsearch-coordinator",{serviceFactory:class extends u.VssService{execute(e){const t=this.pageContext.getService("ITfsPageService"),s=t.getData(),r={searchText:e.queryText};if(s&&s.project){r.project=s.project.name;const e=t.getHorizontalNavigationTeamData();e&&(r.team=e.name)}const o=d.routeUrl(this.pageContext,"ms.vss-work-web.query-search:route",r);return o&&(e.openInNewWindow?window.open(o):l.FastPageSwitch(this.pageContext,o,!0)),Promise.resolve({searchQuery:e,searchResult:new i.ObservableValue(void 0)})}}});u.Services.add("tfssearch-coordinator",{serviceFactory:class extends u.VssService{execute(e){const t=this.pageContext.getService("ITfsPageService"),s=t.getData(),r=t.getHorizontalNavigationTeamData(),o="ms.vss-wiki-web.wiki-project-search-provider"===e.providerId||"ms.vss-wiki-web.wiki-collection-search-provider"===e.providerId,a={text:e.queryText,type:e.type};let n=this.getSearchRouteId(e.providerId,o,!1);s&&s.project&&(n=this.getSearchRouteId(e.providerId,o,!0),a.project=s.project.name,r&&(a.team=r.name));let c="";const u={"ms.vss-wiki-web.wiki-hub-group":"wiki","ms.vss-code-web.code-hub-group":"code","ms.vss-work-web.work-hub-group":"workitems","ms.vss-build-web.build-release-hub-group":"buildrelease","ms.vss-test-web.test-hub-group":"test","ms.vss-tfs-web.project-team-hidden-hub-group":"projects-team","ms.vss-web.home-hub-group":"dashboard","ms.vss-web.project-admin-hub-group":"projects-admin","ms.vss-tfs-web.collection-project-hub-group":"apps-projects","ms.vss-tfs-web.collection-favorites-hub-group":"apps-favorites","ms.vss-tfs-web.collection-work-hub-group":"apps-workitems","ms.vss-tfs-web.collection-pullrequests-hub-group":"apps-pullrequests","ms.vss-tfs-web.collection-rooms-new-account-nav-hub-group":"apps-rooms","ms.vss-tfs-web.collection-users-new-account-nav-hub-group":"apps-users","ms.vss-web.collection-admin-hub-group":"apps-admin"},p=this.pageContext.getService("IVssNavigationService").getDisplayedNavigation(),m=p.length>1&&p[2];if(c=m?u[m]?u[m]:"custom":"search",s&&(r?c+="-Team":s.project?c+="-Project":c+="-Collection"),a.lp=encodeURIComponent(c),!o){let t="";if(e.filters)for(const s in e.filters){const r=e.filters[s];r&&(t+=s+"{"+r[0]+"}")}a.filters=t}e.pageSize&&(a.pageSize=e.pageSize.toString()),void 0!==e.includeFacets&&(a.includeFacets=String(e.includeFacets));const g=d.routeUrl(this.pageContext,n,a)+"";return g&&(e.openInNewWindow?window.open(g):l.FastPageSwitch(this.pageContext,g,!0)),Promise.resolve({searchQuery:e,searchResult:new i.ObservableValue(void 0)})}getSearchRouteId(e,t,s){const r=f.isFeatureFlagEnabled(this.pageContext,"WebAccess.Search.EnableNewRoute",!1);let o;return o=f.isFeatureEnabled(this.pageContext,"ms.vss-search-web.enable-search-lwp",!1)?s?"ms.vss-search-web.project-route":"ms.vss-search-web.collection-route":t?s?r?"ms.vss-search-platform.search-project-route":"ms.vss-search-platform.wikisearch-project-route":r?"ms.vss-search-platform.search-collection-route":"ms.vss-search-platform.wikisearch-collection-route":s?"ms.vss-search-platform.search-project-route":"ms.vss-search-platform.search-collection-route"}}})}(),function(e){t.ShortcutService={},Object.defineProperty(t,"__esModule",{value:!0});u.Services.add("ITfsShortcutService",{serviceFactory:class extends u.VssService{openShortcutDialog(){this.pageContext.getService("IVssLayoutManager").renderCallout(e=>s.createElement(r.WrappedComponent,{dependencies:["ms.vss-tfs-web.keyboard-shortcuts-ui-content"],wrappedType:"KeyboardShortcutsPanel",onDismiss:()=>{e()}},null))}}})}()},["Resources","HeaderActions","ErrorHandling","MyWorkFlyout","NavigationSettings","Page","Navigation","ProductFeatures","ProjectPersona","RestClient/Core","Search/GlobalSearchCoordinator","ShortcutService"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-tfs-web.platform-content"}}));